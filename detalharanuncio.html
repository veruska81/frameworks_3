<!DOCTYPE html>
<html>
<head>
    <title>VERENXOVAIS - Detalhes do Anúncio</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/verenxovais.css') }}">
</head>
<body>
    <div class="menu">
        <a href="{{ url_for('cadusuario') }}">Usuários</a>
        <a href="{{ url_for('cadcategoria') }}">Categorias</a>
        <a href="{{ url_for('cadanuncio') }}">Anúncios</a>
        <a href="{{ url_for('index') }}">Voltar</a>
    </div>

    <div style="padding: 40px 20px 100px 20px;">
        {% if anuncio %}
            <h2>{{ anuncio.nome }}</h2>
            <p><strong>Descrição:</strong> {{ anuncio.descricao }}</p>
            <p><strong>Valor:</strong> R$ {{ "%.2f"|format(anuncio.valor) }}</p>
            <p><strong>Quantidade disponível:</strong> {{ anuncio.quantidade }}</p>
            <p><strong>Data de publicação:</strong> {{ anuncio.data.strftime('%d/%m/%Y') if anuncio.data else '' }}</p>
            
            {% if anuncio.categoria %}
                <p><strong>Categoria:</strong> {{ anuncio.categoria.nome }}</p>
            {% endif %}

            {% if anuncio.usuario %}
                <p><strong>Vendedor:</strong> {{ anuncio.usuario.nome }}</p>
            {% endif %}

            <!-- Formulário  -->
            <h3>Fazer uma pergunta ou resposta</h3>
            <form action="{{ url_for('enviar_pergunta_resposta', id_anuncio=anuncio.id_anuncio) }}" method="POST">
                <label for="descricao">Texto:</label><br>
                <textarea name="descricao" id="descricao" rows="3" required></textarea><br><br>

                <label for="tipo">Tipo:</label>
                <select name="tipo" id="tipo" required>
                    <option value="pergunta">Pergunta</option>
                    <option value="resposta">Resposta</option>
                </select><br><br>

                <!-- Campo com ID do usuário logado -->
                <input type="hidden" name="id_usuario" value="{{ usuario_logado.id_usuario }}">

                <button class="btn btn-primary" type="submit">Enviar</button>
                <button class="btn btn-secondary" type="submit">Comprar</button>
                <button class="btn btn-primary" type="submit">Marcar como Favorito</button>
                </form>
            <hr>

            <!-- Exibe perguntas e respostas -->
            <h3>Perguntas e Respostas</h3>
            {% if mensagens %}
                {% for msg in mensagens %}
                    <p>
                        <strong>{{ msg.tipo|capitalize }}:</strong> {{ msg.descricao }}<br>
                        <small>Por {{ msg.usuario.nome }} em {{ msg.data.strftime('%d/%m/%Y %H:%M') }}</small>
                    </p>
                {% endfor %}
            {% else %}
                <p>Nenhuma pergunta ou resposta ainda.</p>
            {% endif %}

            <a href="{{ url_for('index') }}">← Voltar para anúncios</a>
        {% else %}
            <p>O anúncio solicitado não foi encontrado.</p>
            <a href="{{ url_for('index') }}">← Voltar</a>
        {% endif %}
    </div>
</body>
</html>


